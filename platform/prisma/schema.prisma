generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id             String   @id @default(cuid())
  githubNickname String   @unique
  displayName    String?
  passwordHash   String
  role           UserRole @default(student)
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt

  submissions TaskSubmission[]

  @@map("users")
}

enum UserRole {
  student
  admin
}

model TaskSubmission {
  id        String           @id @default(cuid())
  userId    String
  taskId    String
  lessonId  String
  status    SubmissionStatus @default(submitted)
  content   Json
  createdAt DateTime         @default(now())
  updatedAt DateTime         @updatedAt

  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, taskId])
  @@map("task_submissions")
}

enum SubmissionStatus {
  submitted
  reviewed
}
